# 문제 4

아래의 요구조건에 맞는 설계를 진행하고, 이유를 설명해주세요

작은 스타트업에서 BO 서비스에서 통계 서비스를 개발하여 합니다

1. 각 콘텐츠의 유저의 클릭수, 좋아요수를 보여주는 그래프를 그려야 합니다
2. 클릭과 좋아요 수는 BO의 대시보드에서 확인이 가능하며, 새로고침 버튼을 눌러서 갱신 가능합니다
3. 그래프는 일일 단위로 합계로 표시됩니다

---

✅

> 설계 및 고려사항

`좋아요와 클릭 수 데이터에 대한 파악`

|      구분      |             좋아요              |            클릭 수             |
| :------------: | :-----------------------------: | :----------------------------: |
|  데이터 특성   | 유저와 컨텐츠 간 상태 저장 필요 | 단순 카운트 증가 (누적 데이터) |
| 취소 가능 여부 |       가능 (좋아요 취소)        |               X                |

</br>

`데이터 저장 및 처리방식`

|  구분  |              처리 방식               |                                  설명                                  |
| :----: | :----------------------------------: | :--------------------------------------------------------------------: |
| 좋아요 | API를 통한 실시간 데이터베이스 저장  |              즉시 반영되어야 하며, 유저별 상태 유지 필요               |
|  클릭  | Redis에서 관리 후 배치 작업으로 저장 | 일정 간격으로 MySQL에 저장하여 DB 부하를 줄이고, 시간별 통계 사용 가능 |

</br>

`대시보드 최신화`

- 실시간 업데이트 → WebSocket을 통해 새로고침 없이 최신 데이터 반영
- 배치 작업과 연동 → 클릭 수가 일정 간격마다 MySQL에 저장될 시점에 대시보드 최신화
- Redis 캐싱 불필요 → 백오피스 시스템이므로 사용자가 적어 불필요하다고 판단됨

</br>

`고려사항`

1. 레디스가 다운될 경우 (Click)

- 일정 간격으로 RDB를 활용하여 스냅샷을 저장 및 최신화하여 데이터의 손실을 최소화
- Redis가 복구될 때까지, Node.js 서버에서 임시로 데이터를 캐싱하여 제공
  </br>

2. 과도한 좋아요 등록, 취소 반복 && 클릭 수 조작을 위한 과도한 클릭

- 클라이언트 :
  - 좋아요 : 디바운스 (Debounce) 기법을 활용, 최종적인 상태(좋아요 or 취소)만 서버에 반영
  - 클릭수 : 내부 정책을 기반으로 스로틀 (Throttle) 기법을 활용
- 서버 :
  - 내부 정책에 따른, ip 혹은 유저 기반 요청 제한 적용
  - 예시 정책 : 1분에 100회 이상 요청 시 일정 시간 차단 등

---

### 💡 추가질문 1. - 실제로 구현해본 경험이 있다면, 해당 구현 경험을 서술해주세요

해당 기능을 직접 구현해본 경험은 없지만, 유사한 작업들을 수행하면서 고려했던 요소들을 기반으로 설계 방향을 정리해보았습니다.

이전에 진행했던 프로젝트에서 요청 최적화, 속도 제한, 실시간 반영 등의 기능을 다룬 경험을 바탕으로,

적절한 기법들을 조합하여 구현 방안을 고안했습니다.

### 💡 추가질문 2. - 유저가 클릭을 조작하기위해 빠르게 연타를 한다면, 어떻게 방지할수 있을까요?

답변 질문에 `고려사항` 2번의 내용을 고려하여 정리하면,

클라이언트에서는 "Debounce & Throttle" 기법을 활용하여 요청을 최적화하고,

서버에서는 속도 제한을 적용하여 비정상적인 요청을 방지하는 방식이 가장 효과적일 것 같다고 판단됩니다.
